import{b as o,j as e}from"./vendor-amCHreqW.js";import{s as xe,c as me,T as ye}from"./firebase-BB8yBsbJ.js";import{u as ue,L as V,m as be,b as ge,n as he,o as z,p as W,q as je,r as ke,s as fe,t as ve,v as Ne,w as K}from"./index-DmNrOeFT.js";import{P as Q}from"./PageWrapper-0T27W65_.js";import{S as X}from"./SectionHeading-n1vgtBWH.js";import{u as we,b as Y,c as Se,d as De}from"./useFirestore-C2VHlBku.js";const Ce="mnkjoshi",Le="mnkjoshi",_e=`https://api.cloudinary.com/v1_1/${Ce}/image/upload`;async function H(x,c="portfolio"){const l=new FormData;l.append("file",x),l.append("upload_preset",Le),l.append("folder",c);const p=await fetch(_e,{method:"POST",body:l});if(!p.ok){const g=await p.json().catch(()=>({}));throw new Error(g?.error?.message||"Cloudinary upload failed")}return(await p.json()).secure_url}const y="w-full bg-obsidian border border-white/[0.1] focus:border-cyber/60 rounded-lg px-3 py-2 text-xs outline-none transition-colors text-text_primary placeholder:text-text_muted/50",Z="bg-cyber/90 text-obsidian font-fira font-semibold rounded-lg px-4 py-2 text-xs hover:bg-cyber transition-colors disabled:opacity-40",Ee="border border-white/[0.12] text-text_muted rounded-lg px-4 py-2 text-xs font-fira hover:border-cyber/40 hover:text-cyber transition-colors",G={projects:{title:"",tagline:"",description:"",image:"",stack:[{logo:0,title:"React"}],live:"",yt:"",github:"",featured:!1},hackathons:{name:"",date:"YYYY-MM-DD",description:"",placement:"",isWinner:!1,featured:!1,logo:"",projectLink:"/project/slug"}};function Oe(){const[x,c]=o.useState(""),[l,p]=o.useState(""),[d,g]=o.useState("");async function _(m){m.preventDefault(),g("");try{await me(K,x,l)}catch(i){g(i.message)}}return e.jsx(Q,{children:e.jsxs("div",{className:"max-w-sm mx-auto mt-20",children:[e.jsx(X,{title:"Admin Login"}),e.jsxs("form",{onSubmit:_,className:"flex flex-col gap-4",children:[e.jsx("input",{type:"email",placeholder:"Email",value:x,onChange:m=>c(m.target.value),className:y,required:!0}),e.jsx("input",{type:"password",placeholder:"Password",value:l,onChange:m=>p(m.target.value),className:y,required:!0}),d&&e.jsx("p",{className:"text-red-400 text-xs",children:d}),e.jsx("button",{type:"submit",className:Z,children:"Sign In"})]})]})})}function w({title:x,collectionName:c,fields:l,requiredKeys:p=[],jsonEnabled:d=!1}){const{data:g,loading:_,refetch:m}=we(c),[i,S]=o.useState({}),[k,U]=o.useState(null),[F,E]=o.useState(!1),[A,D]=o.useState({}),[h,I]=o.useState(!1),[j,O]=o.useState(""),[P,f]=o.useState(""),[J,T]=o.useState([]),[ee,R]=o.useState(!1),[v,C]=o.useState(null),[te,N]=o.useState(null),[ae,q]=o.useState(null);o.useEffect(()=>{q(null)},[g]);const u=[...ae??g].sort((a,r)=>(a.order??999)-(r.order??999));function M(){S({}),U(null),O(""),f(""),T([])}function b(a,r){S(t=>({...t,[a]:r}))}async function se(a,r){if(r){D(t=>({...t,[a]:!0}));try{const t=await H(r,c);b(a,t)}catch(t){alert("Image upload failed: "+t.message)}finally{D(t=>({...t,[a]:!1}))}}}function re(a=i){const r={};return l.forEach(t=>{const s=a[t.key];if(t.type==="boolean")r[t.key]=s===!0||s==="true";else if(t.type==="timestamp")r[t.key]=s?ye.fromDate(new Date(s)):null;else if(t.type==="points")r[t.key]=typeof s=="string"?s.split(";").map(n=>n.trim()).filter(Boolean):s||[];else if(t.type==="array")r[t.key]=typeof s=="string"?s.split(",").map(n=>n.trim()).filter(Boolean):s||[];else if(t.type==="stack")try{r[t.key]=typeof s=="string"?JSON.parse(s):s||[]}catch{r[t.key]=[]}else t.type==="image"?r[t.key]=s||"":r[t.key]=s??""}),r}function le(a){const r=[];return p.forEach(t=>{const s=a[t];if(!s||typeof s=="string"&&!s.trim()||Array.isArray(s)&&s.length===0){const n=l.find(L=>L.key===t);r.push(n?.label||t)}}),r}function ne(a){f("");try{const r=JSON.parse(a),t={};return l.forEach(s=>{let n=r[s.key];if(n==null){t[s.key]="";return}s.type==="timestamp"?t[s.key]=typeof n=="string"?n.slice(0,10):"":s.type==="points"?t[s.key]=Array.isArray(n)?n.join("; "):String(n):s.type==="array"?t[s.key]=Array.isArray(n)?n.join(", "):String(n):s.type==="stack"?t[s.key]=typeof n=="string"?n:JSON.stringify(n):s.type==="boolean"?t[s.key]=String(!!n):t[s.key]=String(n)}),S(t),!0}catch(r){return f("Invalid JSON: "+r.message),!1}}async function oe(a){if(a.preventDefault(),!(h&&j.trim()&&!ne(j))){E(!0);try{await new Promise(s=>setTimeout(s,50));const r=re(h&&j.trim()?(()=>{const s=JSON.parse(j),n={};return l.forEach(L=>{n[L.key]=s[L.key]??""}),n})():i),t=le(r);if(t.length){T(t),E(!1);return}T([]),k||(r.order=u.length),k?await Y(c,k,r):await Se(c,r),M(),m()}catch(r){alert(r.message)}finally{E(!1)}}}async function ie(a){confirm("Delete this item?")&&(await De(c,a),m())}function ce(a){I(!1);const r={};l.forEach(t=>{let s=a[t.key];t.type==="timestamp"&&s?.toDate?s=s.toDate().toISOString().slice(0,10):t.type==="timestamp"&&typeof s=="string"?s=s.slice(0,10):t.type==="points"&&Array.isArray(s)?s=s.join("; "):t.type==="array"&&Array.isArray(s)?s=s.join(", "):t.type==="stack"&&(s=JSON.stringify(s,null,2)),r[t.key]=s??""}),S(r),U(a.id)}function de(){const a=G[c];a&&(navigator.clipboard.writeText(JSON.stringify(a,null,2)),R(!0),setTimeout(()=>R(!1),2e3))}function $(a){const r=a.map((t,s)=>({...t,order:s}));q(r),Promise.all(a.map((t,s)=>t.order!==s?Y(c,t.id,{order:s}):null)).catch(t=>{console.error("Order save failed:",t),m()})}function pe(a){if(v===null||v===a){C(null),N(null);return}const r=[...u],[t]=r.splice(v,1);r.splice(a,0,t),C(null),N(null),$(r)}function B(a,r){const t=a+r;if(t<0||t>=u.length)return;const s=[...u];[s[a],s[t]]=[s[t],s[a]],$(s)}return e.jsxs("section",{className:"mb-14",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-fira text-sm font-semibold text-text_primary tracking-wider uppercase",children:[x,e.jsxs("span",{className:"text-text_muted/60 ml-2 normal-case text-[11px]",children:[u.length," ",u.length===1?"item":"items"]})]}),d&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>{I(a=>!a),f("")},className:`flex items-center gap-1.5 text-[11px] font-fira px-3 py-1.5 rounded-lg border transition-colors ${h?"border-cyber/40 text-cyber bg-cyber/5":"border-white/[0.08] text-text_muted hover:border-cyber/30"}`,children:[h?e.jsx(be,{}):e.jsx(ge,{}),h?"Form":"JSON"]}),h&&e.jsxs("button",{type:"button",onClick:de,className:"flex items-center gap-1.5 text-[11px] font-fira px-3 py-1.5 rounded-lg border border-white/[0.08] text-text_muted hover:border-cyber/30 hover:text-cyber transition-colors",children:[e.jsx(he,{}),ee?"Copied!":"Template"]})]})]}),J.length>0&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg px-4 py-3 mb-4",children:[e.jsx("p",{className:"text-red-400 text-xs font-fira font-semibold mb-1",children:"Missing required fields:"}),e.jsx("p",{className:"text-red-400/80 text-xs",children:J.join(", ")})]}),e.jsxs("form",{onSubmit:oe,className:"bg-white/[0.03] border border-white/[0.08] rounded-2xl p-5 mb-5",children:[h&&d?e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("label",{className:"text-text_muted/70 text-[11px] font-fira",children:"Paste JSON below"})}),e.jsx("textarea",{rows:12,value:j,onChange:a=>{O(a.target.value),f("")},placeholder:JSON.stringify(G[c],null,2),className:`${y} resize-y font-mono text-[11px] leading-relaxed ${P?"border-red-500/50":""}`}),P&&e.jsx("p",{className:"text-red-400 text-[11px] mt-1",children:P}),l.some(a=>a.type==="image")&&e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsx("label",{className:"text-text_muted/70 text-[11px] font-fira",children:"Display Image:"}),e.jsxs("label",{className:"flex items-center gap-2 bg-obsidian border border-white/[0.1] hover:border-cyber/40 rounded-lg px-3 py-1.5 text-xs cursor-pointer transition-colors",children:[A.image?e.jsx("span",{className:"text-text_muted text-[11px]",children:"Uploading..."}):i.image?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"text-green-400 text-xs"}),e.jsx("span",{className:"text-green-400 text-[11px]",children:"Uploaded"})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"text-text_muted text-xs"}),e.jsx("span",{className:"text-text_muted text-[11px]",children:"Upload"})]}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:async a=>{const r=a.target.files?.[0];if(r){D(t=>({...t,image:!0}));try{const t=await H(r,c);b("image",t);try{const s=j.trim()?JSON.parse(j):{};s.image=t,O(JSON.stringify(s,null,2))}catch{}}catch(t){alert("Upload failed: "+t.message)}finally{D(t=>({...t,image:!1}))}}}})]}),i.image&&e.jsx("img",{src:i.image,alt:"preview",className:"h-8 w-14 object-cover rounded border border-white/10"})]})]}):e.jsx("div",{className:"grid sm:grid-cols-2 gap-3",children:l.map(a=>{const r=p.includes(a.key);return e.jsxs("div",{className:a.type==="textarea"||a.type==="stack"||a.type==="markdown"||a.type==="points"?"sm:col-span-2":"",children:[e.jsxs("label",{className:"flex items-center gap-1 text-text_muted/70 text-[11px] font-fira mb-1",children:[a.label,r&&e.jsx("span",{className:"text-red-400 text-[10px]",children:"*"})]}),a.type==="markdown"?e.jsx("textarea",{rows:20,value:i[a.key]||"",onChange:t=>b(a.key,t.target.value),placeholder:"Write your markdown here...",className:`${y} resize-y font-mono text-[12px] leading-relaxed min-h-[320px]`,required:r}):a.type==="textarea"?e.jsx("textarea",{rows:4,value:i[a.key]||"",onChange:t=>b(a.key,t.target.value),className:`${y} resize-none`,required:r}):a.type==="points"?e.jsx("textarea",{rows:4,value:i[a.key]||"",onChange:t=>b(a.key,t.target.value),placeholder:"Separate bullet points with semicolons (;)",className:`${y} resize-y`,required:r}):a.type==="stack"?e.jsx("textarea",{rows:3,value:i[a.key]||"",onChange:t=>b(a.key,t.target.value),placeholder:'[{"logo":0,"title":"React"},{"logo":2,"title":"Python"}]',className:`${y} resize-none font-mono text-[11px]`,required:r}):a.type==="boolean"?e.jsxs("select",{value:i[a.key]||"false",onChange:t=>b(a.key,t.target.value),className:y,children:[e.jsx("option",{value:"false",children:"No"}),e.jsx("option",{value:"true",children:"Yes"})]}):a.type==="image"?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 bg-obsidian border border-white/[0.1] hover:border-cyber/40 rounded-lg px-3 py-2 text-xs cursor-pointer transition-colors",children:[A[a.key]?e.jsx("span",{className:"text-text_muted text-[11px]",children:"Uploading..."}):i[a.key]?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"text-green-400 text-xs"}),e.jsx("span",{className:"text-green-400 text-[11px]",children:"Uploaded"})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"text-text_muted text-xs"}),e.jsxs("span",{className:"text-text_muted text-[11px]",children:["Choose image",r?" *":""]})]}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:t=>se(a.key,t.target.files?.[0])})]}),i[a.key]&&e.jsx("img",{src:i[a.key],alt:"preview",className:"h-10 w-16 object-cover rounded border border-white/10"})]}):e.jsx("input",{type:a.type==="timestamp"?"date":"text",value:i[a.key]||"",onChange:t=>b(a.key,t.target.value),className:y,required:r})]},a.key)})}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx("button",{type:"submit",disabled:F,className:Z,children:F?"Saving...":k?"Update":"Create"}),k&&e.jsx("button",{type:"button",onClick:M,className:Ee,children:"Cancel"})]})]}),_?e.jsx(V,{}):e.jsx("div",{className:"space-y-1.5",children:u.map((a,r)=>e.jsxs("div",{draggable:!0,onDragStart:()=>C(r),onDragOver:t=>{t.preventDefault(),N(r)},onDragLeave:()=>N(null),onDrop:()=>pe(r),onDragEnd:()=>{C(null),N(null)},className:`flex items-center gap-2 bg-obsidian/60 border rounded-lg px-3 py-2.5 transition-all ${te===r&&v!==r?"border-cyber/50 bg-cyber/5":v===r?"opacity-40 border-white/[0.08]":"border-white/[0.08]"}`,children:[e.jsx(je,{className:"text-text_muted/50 cursor-grab shrink-0"}),(a.image||a.logo)&&e.jsx("img",{src:a.image||a.logo,alt:"",className:"h-7 w-7 object-contain rounded border border-white/10 shrink-0"}),e.jsx("span",{className:"text-xs text-text_primary truncate flex-1",children:a.title||a.name||a.role||a.id}),e.jsxs("span",{className:"text-text_muted/50 text-[10px] font-fira shrink-0",children:["#",r+1]}),e.jsx("button",{type:"button",onClick:()=>B(r,-1),disabled:r===0,className:"text-text_muted/60 hover:text-cyber disabled:opacity-30 transition-colors",title:"Move up",children:e.jsx(ke,{className:"text-xs"})}),e.jsx("button",{type:"button",onClick:()=>B(r,1),disabled:r===u.length-1,className:"text-text_muted/60 hover:text-cyber disabled:opacity-30 transition-colors",title:"Move down",children:e.jsx(fe,{className:"text-xs"})}),e.jsx("button",{type:"button",onClick:()=>ce(a),className:"text-cyber/60 hover:text-cyber transition-colors",title:"Edit",children:e.jsx(ve,{className:"text-xs"})}),e.jsx("button",{type:"button",onClick:()=>ie(a.id),className:"text-red-400/50 hover:text-red-400 transition-colors",title:"Delete",children:e.jsx(Ne,{className:"text-xs"})})]},a.id))})]})}const Pe=[{key:"projects",label:"Projects"},{key:"hackathons",label:"Hackathons"},{key:"blogs",label:"Blog"},{key:"experiences",label:"Experience"},{key:"leadership",label:"Leadership"}];function Re(){const{user:x,loading:c}=ue(),[l,p]=o.useState(()=>localStorage.getItem("admin_active_tab")||"projects");return o.useEffect(()=>{localStorage.setItem("admin_active_tab",l)},[l]),c?e.jsx(V,{}):x?e.jsxs(Q,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx(X,{title:"Admin",subtitle:x.email}),e.jsx("button",{onClick:()=>xe(K),className:"border border-red-400/40 text-red-400/70 rounded-lg px-3 py-1.5 text-[11px] font-fira hover:bg-red-400/10 hover:text-red-400 transition-colors",children:"Sign Out"})]}),e.jsx("div",{className:"flex gap-1 mb-8 p-1 bg-white/[0.03] border border-white/[0.08] rounded-xl overflow-x-auto",children:Pe.map(d=>e.jsx("button",{onClick:()=>p(d.key),className:`px-4 py-2 rounded-lg text-xs font-fira font-medium transition-all whitespace-nowrap ${l===d.key?"bg-cyber/15 text-cyber border border-cyber/30":"text-text_muted hover:text-text_primary border border-transparent hover:bg-white/[0.03]"}`,children:d.label},d.key))}),l==="projects"&&e.jsx(w,{title:"Projects",collectionName:"projects",jsonEnabled:!0,requiredKeys:["title","tagline","description","image","stack"],fields:[{key:"title",label:"Title",type:"text"},{key:"tagline",label:"Tagline",type:"text"},{key:"description",label:"Description",type:"textarea"},{key:"image",label:"Display Image",type:"image"},{key:"stack",label:"Stack (JSON array)",type:"stack"},{key:"live",label:"Live URL",type:"text"},{key:"yt",label:"YouTube URL",type:"text"},{key:"github",label:"GitHub URL",type:"text"},{key:"featured",label:"Featured",type:"boolean"}]}),l==="hackathons"&&e.jsx(w,{title:"Hackathons",collectionName:"hackathons",jsonEnabled:!0,fields:[{key:"name",label:"Name",type:"text"},{key:"date",label:"Date",type:"timestamp"},{key:"description",label:"Description",type:"textarea"},{key:"placement",label:"Placement",type:"text"},{key:"isWinner",label:"Winner?",type:"boolean"},{key:"featured",label:"Featured",type:"boolean"},{key:"logo",label:"Logo URL",type:"text"},{key:"projectLink",label:"Project Link (e.g. /project/slug)",type:"text"}]}),l==="blogs"&&e.jsx(w,{title:"Blog Posts",collectionName:"blogs",fields:[{key:"title",label:"Title",type:"text"},{key:"date",label:"Date",type:"timestamp"},{key:"content",label:"Content (Markdown)",type:"markdown"},{key:"tags",label:"Tags (comma separated)",type:"array"}]}),l==="experiences"&&e.jsx(w,{title:"Experiences",collectionName:"experiences",fields:[{key:"role",label:"Role / Title",type:"text"},{key:"company",label:"Company",type:"text"},{key:"location",label:"Location",type:"text"},{key:"logo",label:"Company Logo URL (square)",type:"text"},{key:"startDate",label:"Start Date",type:"timestamp"},{key:"endDate",label:"End Date (blank = Present)",type:"timestamp"},{key:"descriptionPoints",label:"Bullet Points (period separated)",type:"points"},{key:"links",label:"Links (comma separated URLs)",type:"array"}]}),l==="leadership"&&e.jsx(w,{title:"Leadership",collectionName:"leadership",fields:[{key:"role",label:"Role / Title",type:"text"},{key:"company",label:"Organization",type:"text"},{key:"location",label:"Location",type:"text"},{key:"logo",label:"Org Logo URL (square)",type:"text"},{key:"startDate",label:"Start Date",type:"timestamp"},{key:"endDate",label:"End Date (blank = Present)",type:"timestamp"},{key:"descriptionPoints",label:"Bullet Points (period separated)",type:"points"},{key:"links",label:"Links (comma separated URLs)",type:"array"}]})]}):e.jsx(Oe,{})}export{Re as default};
